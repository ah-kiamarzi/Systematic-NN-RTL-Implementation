#define SC_INCLUDE_FX

#ifndef SC_NN_H
#define SC_NN_H

#include"systemc.h"
#include"tlm.h"

using namespace tlm;

SC_MODULE(my_NN){
	sc_in<sc_fixed<18,6> > U0;
	sc_in<sc_fixed<18,6> > U1;
	sc_in<sc_fixed<18,6> > U2;
	sc_in<bool> CLK;
    sc_in<bool> RESET;
	sc_out<sc_fixed<18,6> > Y0;
	sc_out<sc_fixed<18,6> > Y1;

	sc_signal<sc_fixed<18,6> >x0;
	sc_signal<sc_fixed<18,6> >x1;
	sc_signal<sc_fixed<18,6> >x2;
	sc_signal<sc_fixed<18,6> >x3;

	sc_fixed<18,6> tanh[128];
	sc_fixed<18,6> b[12];
	sc_fixed<18,6> w[64];
	sc_fixed<18,6> c[8];
	sc_uint<3> n;

	void NN_func();
	void out_func();

	SC_CTOR(my_NN)
	{
		SC_METHOD(NN_func);
		sensitive_pos << CLK;
		sensitive << RESET.neg();
		SC_METHOD(out_func);
		sensitive << x0<<x1<<x2<<x3;


		x0 = 0;
		x1 = 0;
		x2 = 0;
		x3 = 0;

		n = 0;


		tanh[0] = 0.0000000000000000000000000;
		tanh[1] = 0.2449186624037091308814240;
		tanh[2] = 0.4621171572600097365857152;
		tanh[3] = 0.6351489523872873022014574;
		tanh[4] = 0.7615941559557648510292438;
		tanh[5] = 0.8482836399575128805139457;
		tanh[6] = 0.9051482536448663962502792;
		tanh[7] = 0.9413755384972873896387568;
		tanh[8] = 0.9640275800758169033599643;
		tanh[9] = 0.9780261147388136233615796;
		tanh[10] = 0.9866142981514303134105148;
		tanh[11] = 0.9918597245682077012673972;
		tanh[12] = 0.9950547536867304643237730;
		tanh[13] = 0.9969976354865259793314181;
		tanh[14] = 0.9981778976111986834141021;
		tanh[15] = 0.9988944427261527980732581;
		tanh[16] = 0.9993292997390670340251972;
		tanh[17] = 0.9995931460438896021258870;
		tanh[18] = 0.9997532108480274848361091;
		tanh[19] = 0.9998503075449787225181808;
		tanh[20] = 0.9999092042625951082257529;
		tanh[21] = 0.9999449286177708451361923;
		tanh[22] = 0.9999665971563037603075941;
		tanh[23] = 0.9999797400180382433987347;
		tanh[24] = 0.9999877116507955854274314;
		tanh[25] = 0.9999925467214316743280733;
		tanh[26] = 0.9999954793514042039603851;
		tanh[27] = 0.9999972580855862602788875;
		tanh[28] = 0.9999983369439446878601530;
		tanh[29] = 0.9999989913051835488388974;
		tanh[30] = 0.9999993881955461239030569;
		tanh[31] = 0.9999996289217962797124528;
		tanh[32] = 0.9999997749296758442483224;
		tanh[33] = 0.9999998634879417869214535;
		tanh[34] = 0.9999999172012490333827373;
		tanh[35] = 0.9999999497800181602613634;
		tanh[36] = 0.9999999695400410004708647;
		tanh[37] = 0.9999999815251008339345162;
		tanh[38] = 0.9999999887944072129997153;
		tanh[39] = 0.9999999932034643324030299;
		tanh[40] = 0.9999999958776927266868029;
		tanh[41] = 0.9999999974996942597726957;
		tanh[42] = 0.9999999984834878619111009;
		tanh[43] = 0.9999999990801888838376499;
		tanh[44] = 0.9999999994421063798100136;
		tanh[45] = 0.9999999996616204533950167;
		tanh[46] = 0.9999999997947623953109542;
		tanh[47] = 0.9999999998755171315423240;
		tanh[48] = 0.9999999999244972848089219;
		tanh[49] = 0.9999999999542052986356566;
		tanh[50] = 0.9999999999722241073030204;
		tanh[51] = 0.9999999999831530317351280;
		tanh[52] = 0.9999999999897818403482574;
		tanh[53] = 0.9999999999938024020096350;
		tanh[54] = 0.9999999999962408958609217;
		tanh[55] = 0.9999999999977200459966298;
		tanh[56] = 0.9999999999986171062005269;
		tanh[57] = 0.9999999999991612265048957;
		tanh[58] = 0.9999999999994912958101168;
		tanh[59] = 0.9999999999996914690214567;
		tanh[60] = 0.9999999999998128163980482;
		tanh[61] = 0.9999999999998865352068833;
		tanh[62] = 0.9999999999999311661724732;
		tanh[63] = 0.9999999999999582556142741;
		tanh[64] = 0.9999999999999746869150385;
		tanh[65] = 0.9999999999999846789222602;
		tanh[66] = 0.9999999999999906741265931;
		tanh[67] = 0.9999999999999943378625744;
		tanh[68] = 0.9999999999999965583086237;
		tanh[69] = 0.9999999999999978905762532;
		tanh[70] = 0.9999999999999987787546729;
		tanh[71] = 0.9999999999999992228438828;
		tanh[72] = 0.9999999999999995559107901;
		tanh[73] = 0.9999999999999996669330926;
		tanh[74] = 0.9999999999999997779553951;
		tanh[75] = 0.9999999999999998889776975;
		tanh[76] = 0.9999999999999998889776975;
		tanh[77] = 1.0000000000000000000000000;
		tanh[78] = 1.0000000000000000000000000;
		tanh[79] = 1.0000000000000000000000000;
		tanh[80] = 1.0000000000000000000000000;
		tanh[81] = 1.0000000000000000000000000;
		tanh[82] = 1.0000000000000000000000000;
		tanh[83] = 1.0000000000000000000000000;
		tanh[84] = 1.0000000000000000000000000;
		tanh[85] = 1.0000000000000000000000000;
		tanh[86] = 1.0000000000000000000000000;
		tanh[87] = 1.0000000000000000000000000;
		tanh[88] = 1.0000000000000000000000000;
		tanh[89] = 1.0000000000000000000000000;
		tanh[90] = 1.0000000000000000000000000;
		tanh[91] = 1.0000000000000000000000000;
		tanh[92] = 1.0000000000000000000000000;
		tanh[93] = 1.0000000000000000000000000;
		tanh[94] = 1.0000000000000000000000000;
		tanh[95] = 1.0000000000000000000000000;
		tanh[96] = 1.0000000000000000000000000;
		tanh[97] = 1.0000000000000000000000000;
		tanh[98] = 1.0000000000000000000000000;
		tanh[99] = 1.0000000000000000000000000;
		tanh[100] = 1.0000000000000000000000000;
		tanh[101] = 1.0000000000000000000000000;
		tanh[102] = 1.0000000000000000000000000;
		tanh[103] = 1.0000000000000000000000000;
		tanh[104] = 1.0000000000000000000000000;
		tanh[105] = 1.0000000000000000000000000;
		tanh[106] = 1.0000000000000000000000000;
		tanh[107] = 1.0000000000000000000000000;
		tanh[108] = 1.0000000000000000000000000;
		tanh[109] = 1.0000000000000000000000000;
		tanh[110] = 1.0000000000000000000000000;
		tanh[111] = 1.0000000000000000000000000;
		tanh[112] = 1.0000000000000000000000000;
		tanh[113] = 1.0000000000000000000000000;
		tanh[114] = 1.0000000000000000000000000;
		tanh[115] = 1.0000000000000000000000000;
		tanh[116] = 1.0000000000000000000000000;
		tanh[117] = 1.0000000000000000000000000;
		tanh[118] = 1.0000000000000000000000000;
		tanh[119] = 1.0000000000000000000000000;
		tanh[120] = 1.0000000000000000000000000;
		tanh[121] = 1.0000000000000000000000000;
		tanh[122] = 1.0000000000000000000000000;
		tanh[123] = 1.0000000000000000000000000;
		tanh[124] = 1.0000000000000000000000000;
		tanh[125] = 1.0000000000000000000000000;
		tanh[126] = 1.0000000000000000000000000;
		tanh[127] = 1.0000000000000000000000000;

		w[0] = 0.0000000000000000000000000;
		w[1] = 0.0000000000000000000000000;
		w[2] = 0.0000000000000000000000000;
		w[3] = 0.0000000000000000000000000;
		w[4] = 0.0000000000000000000000000;
		w[5] = 0.0000000000000000000000000;
		w[6] = 0.0000000000000000000000000;
		w[7] = 0.0000000000000000000000000;
		w[8] = 0.0000000000000000000000000;
		w[9] = 0.0000000000000000000000000;
		w[10] = 0.0000000000000000000000000;
		w[11] = 0.0000000000000000000000000;
		w[12] = 0.0000000000000000000000000;
		w[13] = 0.0000000000000000000000000;
		w[14] = 0.0000000000000000000000000;
		w[15] = 0.0000000000000000000000000;
		w[16] = 9.5716694824294599186487176;
		w[17] = 4.8537564872284102435173736;
		w[18] = 8.0028046888880002285304727;
		w[19] = 1.4188633862721500289438836;
		w[20] = 4.2176128262627496923187209;
		w[21] = 9.1573552518906691233269157;
		w[22] = 7.9220732955955401877190525;
		w[23] = 9.5949242639290304168753210;
		w[24] = 6.5574069915658697027538437;
		w[25] = 0.3571167857418960367432703;
		w[26] = 8.4912930586877699568049138;
		w[27] = 9.3399324775755090399798064;
		w[28] = 6.7873515485777407008072259;
		w[29] = 7.5774013057833302653421015;
		w[30] = 7.4313246812491593473737339;
		w[31] = 3.9222701953416798659191045;
		w[32] = 6.5547789017755695439859664;
		w[33] = 1.7118668781156198832604787;
		w[34] = 7.0604608801960901942607052;
		w[35] = 0.3183284637742069822508029;
		w[36] = 2.7692298496089002846076710;
		w[37] = 0.4617139063115389685520995;
		w[38] = 0.9713178123584749190655430;
		w[39] = 8.2345782832729295108720180;
		w[40] = 6.9482862297581702293314265;
		w[41] = 3.1709948006086103866607573;
		w[42] = 9.5022204883835499344968412;
		w[43] = 0.3444608050290880463251142;
		w[44] = 4.3874435965639797530002397;
		w[45] = 3.8155845709300799661889414;
		w[46] = 7.6551678814900201430759807;
		w[47] = 7.9519990113706295886686348;
		w[48] = 1.8687260455437901818243063;
		w[49] = 4.8976439578823098841553474;
		w[50] = 4.4558620071090002667801855;
		w[51] = 6.4631301011126494060476944;
		w[52] = 7.0936483085807298110125885;
		w[53] = 7.5468668198236095179254335;
		w[54] = 2.7602507699857796730213977;
		w[55] = 6.7970267685367504739701872;
		w[56] = 6.5509800397384099213127229;
		w[57] = 1.6261173519463101300175367;
		w[58] = 1.1899768155837699978860655;
		w[59] = 4.9836405198214297485037605;
		w[60] = 9.5974395851608100826979353;
		w[61] = 3.4038572666613298167703761;
		w[62] = 5.8526775097977701278750828;
		w[63] = 2.2381193949113700192299348;

		b[0]  = 0.814723686393179;
		b[1]  = 0.905791937075619;
		b[2]  = 0.126986816293506;
		b[3]  = 0.913375856139019;
		b[4]  = 0.632359246225410;
		b[5]  = 0.0975404049994095;
		b[6]  = 0.278498218867048;
		b[7]  = 0.546881519204984;
		b[8]  = 0.957506835434298;
		b[9]  = 0.964888535199277;
		b[10] = 0.157613081677548;
		b[11] = 0.970592781760616;

		c[0] = 3.756335296528265;
		c[1] = 4.454516262678995;
		c[2] = 1.275475577296345;
		c[3] = 4.796457126027220;
		c[4] = 2.529785258325710;
		c[5] = 2.736077649819015;
		c[6] = 3.495383613283430;
		c[7] = 0.693122214143395;

#pragma HLS ARRAY_PARTITION variable=c complete dim=1
#pragma HLS ARRAY_PARTITION variable=w complete dim=1
#pragma HLS ARRAY_PARTITION variable=b complete dim=1
#pragma HLS ARRAY_PARTITION variable=tanh complete dim=1

	}

};


#endif

